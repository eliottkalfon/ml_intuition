<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Numerical Feature Scaling – Machine Learning Intuition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/end-to-end.html" rel="next">
<link href="../chapters/missing-categorical-values.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CRT8LCGF89"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CRT8LCGF89');
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/data-preprocessing.html">Data Preprocessing</a></li><li class="breadcrumb-item"><a href="../chapters/scaling.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Numerical Feature Scaling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Machine Learning Intuition</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">First Prediction with Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/defining-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Defining Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/types-ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Other Types of Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ai-ml-ds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Machine Learning, Artificial Intelligence and Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/data-space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data and Space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/distance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Distance and Similarity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/neighbours.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Neighbours</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Model Evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/model-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Model Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/evaluation-classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Evaluating Classification Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/evaluation-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Evaluating Regression Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Decision Trees</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/trees-intuition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Decision Trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/splitting-maths.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Evaluating Splits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/recursion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Splitting Recursively</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/trees-proba-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Probabilities and Regression with Decision Trees</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Preprocessing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/data-preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Data Preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/categorical-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Encoding Categorical Features</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/datetime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Representing Dates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/missing-numerical-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Dealing with Missing Numeric Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/missing-categorical-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dealing with Missing Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/scaling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Numerical Feature Scaling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Bringing it all Together</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/end-to-end.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">End-to-End Machine Learning Project</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/generative-ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Machine Learning and Generative AI</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-mechanics" id="toc-the-mechanics" class="nav-link active" data-scroll-target="#the-mechanics"><span class="header-section-number">20.1</span> The Mechanics</a></li>
  <li><a href="#min-max-scaling" id="toc-min-max-scaling" class="nav-link" data-scroll-target="#min-max-scaling"><span class="header-section-number">20.2</span> Min-Max Scaling</a></li>
  <li><a href="#standardisation" id="toc-standardisation" class="nav-link" data-scroll-target="#standardisation"><span class="header-section-number">20.3</span> Standardisation</a>
  <ul class="collapse">
  <li><a href="#describing-a-series" id="toc-describing-a-series" class="nav-link" data-scroll-target="#describing-a-series"><span class="header-section-number">20.3.1</span> Describing a series</a></li>
  <li><a href="#standardising-series-with-mean-and-standard-deviation" id="toc-standardising-series-with-mean-and-standard-deviation" class="nav-link" data-scroll-target="#standardising-series-with-mean-and-standard-deviation"><span class="header-section-number">20.3.2</span> Standardising series with Mean and Standard Deviation</a></li>
  </ul></li>
  <li><a href="#information-leakage" id="toc-information-leakage" class="nav-link" data-scroll-target="#information-leakage"><span class="header-section-number">20.4</span> Information Leakage</a></li>
  <li><a href="#final-thoughts" id="toc-final-thoughts" class="nav-link" data-scroll-target="#final-thoughts"><span class="header-section-number">20.5</span> Final Thoughts</a></li>
  <li><a href="#solutions" id="toc-solutions" class="nav-link" data-scroll-target="#solutions"><span class="header-section-number">20.6</span> Solutions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/data-preprocessing.html">Data Preprocessing</a></li><li class="breadcrumb-item"><a href="../chapters/scaling.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Numerical Feature Scaling</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Numerical Feature Scaling</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Lists of numbers come in all shapes and sizes. But why should we care?</p>
<p>Many Machine Learning algorithms operate on data as <strong>vectors</strong> or <strong>points in space</strong>. <a href="../chapters/neighbours.html">KNN</a> generates predictions based on the <a href="../chapters/distance.html"><strong>distance</strong></a> or similarities between observations. <a href="../chapters/trees-intuition.html">Decision Trees</a> split the feature space to separate data from different classes or labels.</p>
<p>Thinking of nearest neighbours, feature scaling does matter. Let’s imagine you are building a model to predict property prices, using two features:</p>
<ul>
<li>Surface Area in m²</li>
<li>Number of rooms</li>
</ul>
<p>Example properties in the training data include:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Size (m²)</th>
<th style="text-align: center;">Number of rooms</th>
<th style="text-align: center;">Price (k €)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">320</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">400</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">350</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">310</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">600</td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">330</td>
</tr>
</tbody>
</table>
<p>When plotting this data over a two-dimensional space on the interval [0, 200], we get:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/property_squished.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Property data without scaling</figcaption>
</figure>
</div>
<p>As you can see, most of the variation is generated by the <strong>surface area</strong>. This is why the data appears so compressed.</p>
<p>The dominance of surface area over the number of rooms can also be seen when calculating the Euclidean Distance between properties.</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\text{Distance between property A and B:} \\
&amp;d_{AB} = \sqrt{(80 - 60)^2 + (3 - 2)^2} \\
&amp;\phantom{d_{AB}} = \sqrt{20^2 + 1^2} \\
&amp;\phantom{d_{AB}} = \sqrt{400 + 1} \quad \text{surface area dominates}\\
&amp;\phantom{d_{AB}} = \sqrt{401} \\
&amp;\phantom{d_{AB}} \approx 20.02 \\
\\
&amp;\text{Distance between property A and C:} \\
&amp;d_{AC} = \sqrt{(120 - 60)^2 + (5 - 2)^2} \\
&amp;\phantom{d_{AC}} = \sqrt{60^2 + 3^2} \\
&amp;\phantom{d_{AC}} = \sqrt{3600 + 9} \quad \text{here again}\\
&amp;\phantom{d_{AC}} = \sqrt{3609} \\
&amp;\phantom{d_{AC}} \approx 60.08
\end{aligned}
\]</span></p>
<p>As you can see, in both cases, the distance between two properties is nearly fully determined by the surface area difference. The distance between number of rooms is dwarfed by the difference in surface area. We could get a more even distribution by rescaling the axes:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/property_rescaled.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Property Data Rescaled</figcaption>
</figure>
</div>
<p>While rescaling the axes is a better way to <strong>visualise</strong> the data, it does not solve the problem in calculating the distance between two observations.</p>
<section id="the-mechanics" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="the-mechanics"><span class="header-section-number">20.1</span> The Mechanics</h2>
<p>To do so, we need to <strong>scale</strong> both features so that they (roughly) have the same <strong>range, mean and variance</strong>:</p>
<ul>
<li>Range is the distance between the minimum and the maximum of a series.</li>
<li>Mean is the average of a series</li>
<li>Variance can have many definitions, for now, let’s define it as the degree to which <strong>numbers fluctuate</strong></li>
</ul>
<p>As an example, the surface area column has a higher variance than the number of rooms column. The numbers <strong>fluctuate more</strong> from one to the other. As a consequence, surface area has a larger impact than the number of rooms on the distance function.</p>
<p>What if we could transform both the number of rooms and the surface area to series of number between 0 and 1? This would solve the issue of distance calculation. The following section will explore a way to do this.</p>
</section>
<section id="min-max-scaling" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="min-max-scaling"><span class="header-section-number">20.2</span> Min-Max Scaling</h2>
<p>Let’s imagine the following series of numbers: <span class="math inline">\(\{0, 30, 40, 60, 90, 100\}\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/number_line.png" class="img-fluid figure-img"></p>
<figcaption>Series 0-100</figcaption>
</figure>
</div>
<p>A simple way to get these numbers in the 0-1 interval would be to divide all of them by 100:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Value</th>
<th style="text-align: center;">Scaled</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: center;">30</td>
<td style="text-align: center;">0.30</td>
</tr>
<tr class="odd">
<td style="text-align: center;">40</td>
<td style="text-align: center;">0.40</td>
</tr>
<tr class="even">
<td style="text-align: center;">60</td>
<td style="text-align: center;">0.60</td>
</tr>
<tr class="odd">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.90</td>
</tr>
<tr class="even">
<td style="text-align: center;">100</td>
<td style="text-align: center;">1.00</td>
</tr>
</tbody>
</table>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/div100.png" class="img-fluid figure-img"></p>
<figcaption>Series scaled to 0-1</figcaption>
</figure>
</div>
<p>If the original series has numbers going from 0-150: <span class="math inline">\(\{0, 10, 60, 70, 120, 150\}\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/max150.png" class="img-fluid figure-img"></p>
<figcaption>Series 0-150</figcaption>
</figure>
</div>
<p>We could also get it back to the 0-1 interval by dividing all numbers by 150, the <strong>maximum</strong> of the series:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Value</th>
<th style="text-align: center;">Scaled</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;">0.07</td>
</tr>
<tr class="odd">
<td style="text-align: center;">60</td>
<td style="text-align: center;">0.40</td>
</tr>
<tr class="even">
<td style="text-align: center;">70</td>
<td style="text-align: center;">0.47</td>
</tr>
<tr class="odd">
<td style="text-align: center;">120</td>
<td style="text-align: center;">0.80</td>
</tr>
<tr class="even">
<td style="text-align: center;">150</td>
<td style="text-align: center;">1.00</td>
</tr>
</tbody>
</table>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/div150.png" class="img-fluid figure-img"></p>
<figcaption>Series 0-1 (by 150)</figcaption>
</figure>
</div>
<p>This is a good start. For series ranging from 0 to a given number, we can divide all numbers in the series by their maximum. This scales the series to the range 0-1.</p>
<p>Now, what if the numbers in the series range from 50 to 250?</p>
<p>Series: <span class="math inline">\(\{50, 90, 120, 170, 220, 250\}\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/max250.png" class="img-fluid figure-img"></p>
<figcaption>Series 50-250</figcaption>
</figure>
</div>
<p>Dividing the numbers of the series by the maximum would not make the full use of the 0-1 interval:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Value</th>
<th style="text-align: center;">Scaled (÷250)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.20</td>
</tr>
<tr class="even">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.36</td>
</tr>
<tr class="odd">
<td style="text-align: center;">120</td>
<td style="text-align: center;">0.48</td>
</tr>
<tr class="even">
<td style="text-align: center;">170</td>
<td style="text-align: center;">0.68</td>
</tr>
<tr class="odd">
<td style="text-align: center;">220</td>
<td style="text-align: center;">0.88</td>
</tr>
<tr class="even">
<td style="text-align: center;">250</td>
<td style="text-align: center;">1.00</td>
</tr>
</tbody>
</table>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/div250.png" class="img-fluid figure-img"></p>
<figcaption>Series 0.2-1 (by 250)</figcaption>
</figure>
</div>
<p>The minimum achieved there is <span class="math inline">\(50/250 = 0.2\)</span>. This means that 20% of the allowed range will be left <strong>empty</strong>, a suboptimal outcome. How could this problem be solved?</p>
<p>In the end, we want the minimum of the series to be mapped to 0, and the maximum to 1. To achieve this, we can use the following formula:</p>
<p><span class="math display">\[
\text{Scaled Value} = \frac{x - x_{\text{min}}}{x_{\text{max}} - x_{\text{min}}}
\]</span></p>
<p>With:</p>
<ul>
<li><span class="math inline">\(x\)</span> the value to be scaled</li>
<li><span class="math inline">\(x_{\text{min}}\)</span> and <span class="math inline">\(x_{\text{max}}\)</span> the minimum and maximum of the series</li>
</ul>
<p>Let’s take this formula part by part:</p>
<ul>
<li>The numerator: <span class="math inline">\(x - x_{\text{min}}\)</span>, computes the <strong>distance</strong> between the value and the minimum</li>
<li>The denominator: <span class="math inline">\(x_{\text{max}} - x_{\text{min}}\)</span>, divides this distance by the <strong>largest distance</strong> in the series, the distance between the maximum and minimum values</li>
</ul>
<p>This formula will be maximised when the value is the maximum of the series, <span class="math inline">\(\text{original value} = x_{\text{max}}\)</span>:</p>
<p><span class="math display">\[
\text{Scaled Value of Max} = \frac{x_{\text{max}} - x_{\text{min}}}{x_{\text{max}}} - x_{\text{min}} = 1
\]</span></p>
<p>And be minimised when the value is the minimum of the series, <span class="math inline">\(\text{original value} = x_{\text{min}}\)</span>:</p>
<p><span class="math display">\[
\text{Scaled Value of Min} = \frac{x_{\text{min}} - x_{\text{min}}}{x_{\text{max}} - x_{\text{min}}} = 0
\]</span></p>
<p>With this formula, any series of numbers can be mapped to the range <span class="math inline">\([0,1]\)</span>, solving the problems.</p>
<p>The following table shows its application to the example series above:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Value</th>
<th style="text-align: center;">Scaled (÷250)</th>
<th style="text-align: center;">Scaled (MinMax)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">50</td>
<td style="text-align: center;">0.20</td>
<td style="text-align: center;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: center;">90</td>
<td style="text-align: center;">0.36</td>
<td style="text-align: center;">0.20</td>
</tr>
<tr class="odd">
<td style="text-align: center;">120</td>
<td style="text-align: center;">0.48</td>
<td style="text-align: center;">0.35</td>
</tr>
<tr class="even">
<td style="text-align: center;">170</td>
<td style="text-align: center;">0.68</td>
<td style="text-align: center;">0.60</td>
</tr>
<tr class="odd">
<td style="text-align: center;">220</td>
<td style="text-align: center;">0.88</td>
<td style="text-align: center;">0.85</td>
</tr>
<tr class="even">
<td style="text-align: center;">250</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">1.00</td>
</tr>
</tbody>
</table>
<div id="exr-min-max" class="exercise theorem">
<p><span class="theorem-title"><strong>Exercise 20.1</strong></span> Use Min-Max Scaling to map both surface area and number of rooms to the range <span class="math inline">\([0,1]\)</span></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Size (m²)</th>
<th style="text-align: center;">Number of rooms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="standardisation" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="standardisation"><span class="header-section-number">20.3</span> Standardisation</h2>
<p>The following section will get a bit more mathematical and can be skipped (<a href="#information-leakage">next section</a>).</p>
<p>Min-Max Scaling is not the only way to preprocess a series of numbers in different scales. Another approach is called <strong>Standardisation</strong>. The idea of standardisation is to make the <strong>distributions of the series</strong> similar. The distribution is a representation of how frequently the values of a variable occur.</p>
<p>Let’s make this more concrete with an example:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/three_series.png" class="img-fluid figure-img"></p>
<figcaption>Three series with different means and variances</figcaption>
</figure>
</div>
<p>These series have very different distributions. The difference of <strong>scale</strong> would have a negative impact on Machine Learning algorithms like <a href="../chapters/neighbours.html">KNN</a>.</p>
<p>Why can we say that these two series have different distributions?</p>
<ul>
<li>They do not have the same <strong>mean</strong> or <strong>centre</strong></li>
<li>They do not have the same <strong>spread</strong> or <strong>variance</strong> around their respective means</li>
</ul>
<p>These are the two discrepancies that Standardisation aims to correct.</p>
<section id="describing-a-series" class="level3" data-number="20.3.1">
<h3 data-number="20.3.1" class="anchored" data-anchor-id="describing-a-series"><span class="header-section-number">20.3.1</span> Describing a series</h3>
<p>Before we start, it is important to define some important concepts of <strong>descriptive statistics</strong>.</p>
<p>Breaking this term down:</p>
<ul>
<li>Statistics is a branch of mathematics focussing on the collection and analysis of <strong>collections of data</strong></li>
<li>Descriptive statistics is a branch of statistics concerned with the <strong>summarisation and description</strong> of a collection of data</li>
</ul>
<p>The Minimum and Maximum of a series are descriptive statistics, representing the lowest and highest number of a collection of numbers.</p>
<p>This section will introduce further concepts in descriptive statistics:</p>
<ul>
<li>Mean</li>
<li>Variance</li>
<li>Standard Deviation</li>
</ul>
<p>If you are already familiar with these, feel free to skip to the <a href="#information-leakage">next section</a>.</p>
<section id="mean" class="level4" data-number="20.3.1.1">
<h4 data-number="20.3.1.1" class="anchored" data-anchor-id="mean"><span class="header-section-number">20.3.1.1</span> Mean</h4>
<p>The mean represents the “centre” of a collection of numbers. There are different types of means in mathematics. This book will focus on the arithmetic mean, also referred to as the “average”. It is noted <span class="math inline">\(\bar{x}\)</span> or <span class="math inline">\(\mu\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Other kinds of mean
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are other types of means, used to average different types of values. They all have different properties, advantages and drawbacks</p>
<p>Geometric mean: <span class="math inline">\(\left(\prod_{i=1}^n x_i\right)^{1/n}\)</span>. It is useful for averaging ratios, growth rates, or percentages. The scary <span class="math inline">\(\prod_{i=1}^n\)</span> is the letter pi in capital letter, representing a product. <span class="math inline">\(\prod_{i=1}^n i = 1 \cdot 2 \cdot \dots \cdot n\)</span></p>
<p>Using geometric means, a single 0 in the series will make the mean 0. It is still widely used in economics to average multiplicative phenomena like rates of growth.</p>
<p>Harmonic mean: <span class="math inline">\(\left(\frac{1}{n}\sum_{i=1}^n \frac{1}{x_i}\right)^{-1}\)</span>. It is useful for rates, such as model Precision or Recall (Model Evaluation <a href="../chapters/evaluation-classification.html">chapter</a>).</p>
<p>The harmonic mean of model Precision and Recall is called the F1-score. It is commonly used to find models that have a good trade-off of both metrics.</p>
<p><span class="math display">\[
F_1 = 2 \cdot \frac{\text{Precision} \cdot \text{Recall}}{\text{Precision} + \text{Recall}}
\]</span></p>
</div>
</div>
</div>
<p>The arithmetic mean of a series of <span class="math inline">\(n\)</span> observations, <span class="math inline">\(\{x_1, x_2, \dots, x_n\}\)</span> is computed with the following formula:</p>
<p><span class="math display">\[
\bar{x} = \frac{x_1 + x_2 + \cdots + x_n}{n}
\]</span></p>
<p>Using the <span class="math inline">\(\Sigma\)</span> summation operator: <span class="math display">\[
\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i
\]</span></p>
<p>Both notations are equivalent. If you find the <span class="math inline">\(\Sigma\)</span> notation intimidating, refer to the <a href="../chapters/distance.html">Distance chapter</a> for an intuitive explanation.</p>
<p>If you ever calculated your average grade at school, you probably used an arithmetic mean or a weighted average.</p>
<p>As an example, these two series have different means:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Series 1</th>
<th style="text-align: center;">Series 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">16</td>
</tr>
</tbody>
</table>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/two_series_different_distributions.png" class="img-fluid figure-img"></p>
<figcaption>Two series with different means</figcaption>
</figure>
</div>
<p>The mean of the first series can be calculated with the formula shown above:</p>
<p><span class="math display">\[
\text{Mean}_{x_1} = \frac{1 + 2 + 4 + 5 + 8}{5} = 4
\]</span></p>
<div id="exr-mean-series" class="exercise theorem">
<p><span class="theorem-title"><strong>Exercise 20.2</strong></span> Show that the mean of the second series is equal to <span class="math inline">\(10\)</span>.</p>
</div>
</section>
<section id="variance-and-standard-deviation" class="level4" data-number="20.3.1.2">
<h4 data-number="20.3.1.2" class="anchored" data-anchor-id="variance-and-standard-deviation"><span class="header-section-number">20.3.1.2</span> Variance and Standard Deviation</h4>
<p>The following two series have the same mean, and yet, they look very different:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Series 1</th>
<th style="text-align: center;">Series 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">11</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">14</td>
<td style="text-align: center;">16</td>
</tr>
</tbody>
</table>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/two_series_same_mean.png" class="img-fluid figure-img"></p>
<figcaption>Two series, same mean, different variance</figcaption>
</figure>
</div>
<p>The main difference between these two series is that the second has a much greater variance than the first. Variance refers to the <strong>spread</strong> of the individual values around the mean.</p>
<p>How would you quantify the spread of values around the mean? How would you summarise this spread in a single number?</p>
<p>Hint: You could refer to the <a href="../chapters/evaluation-regression.html">Regression Model Evaluation</a> chapter.</p>
<p>The distance between an individual value (<span class="math inline">\(x\)</span>) and the mean (<span class="math inline">\(\bar{x}\)</span>) can be calculated as follows:</p>
<p><span class="math display">\[
x - \bar{x}
\]</span></p>
<p>This works for a single value. Now, how would you aggregate these distances? Remember that positive and negative distances should <strong>not</strong> cancel out.</p>
<p>If you thought of using the <strong>absolute value</strong> or <strong>squared differences</strong>, well done! This is the right intuition. The variance is the average square difference between individual values and the mean.</p>
<p><span class="math display">\[
\mathrm{Var}(x) = \frac{(x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 + \cdots + (x_n - \bar{x})^2}{n}
\]</span></p>
<p>Sigma notation: <span class="math display">\[
\mathrm{Var}(x) = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2
\]</span></p>
<p>Does this remind you of a formula? This is very similar to the <strong>Mean Squared Error</strong> (MSE), the average squared difference between model predictions and true labels. The variance is in a sense the MSE of the average.</p>
<p>If a model kept predicting the average for all observations, its Mean Squared Error would be the variance!</p>
<p>The variance for the first series can be computed as follows:</p>
<p><span class="math display">\[
\begin{aligned}
\bar{x}_1 &amp;= \frac{7 + 8 + 10 + 11 + 14}{5} = 10 \\
\mathrm{Var}(x_1) &amp;= \frac{(7-10)^2 + (8-10)^2 + (10-10)^2}{5} \\
&amp;\quad + \frac{(11-10)^2 + (14-10)^2}{5} \\
                  &amp;= \frac{9 + 4 + 0 + 1 + 16}{5} = \frac{30}{5} = 6
\end{aligned}
\]</span></p>
<div id="exr-variance" class="exercise theorem">
<p><span class="theorem-title"><strong>Exercise 20.3</strong></span> Compute the variance of the second series. Prove that it is <span class="math inline">\(16\)</span>.</p>
</div>
<p>Is there something strange with these variance numbers? Similar to the Mean Squared Errors, they are much larger than the scale of the original series.</p>
<p>How would you solve this problem? Here again, the <a href="../chapters/evaluation-regression.html">Regression Model Evaluation</a> chapter could be helpful. Just like the Mean Squared Error and the Root Mean Squared Error, you could simply take the <strong>square root</strong> of the variance.</p>
<p>This number gives you a much more interpretable idea of the typical spread between individual values and the mean of a series. This measure is called the Standard Deviation, commonly noted <span class="math inline">\(\sigma\)</span>.</p>
<p><span class="math display">\[
\sigma = \sqrt{\mathrm{Var}(x)}
\]</span></p>
<p>This standard deviation measures the <strong>average spread</strong> from the mean in a series.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Are descriptive statistics this descriptive?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>As surprising as it may seem, all the datasets have the same mean, variance and standard deviation for both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. This is the famous Ascombe Quartet.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/anscombe_quartet.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Anscombe’s quartet</figcaption>
</figure>
</div>
<p>Descriptive statistics for Anscombe’s quartet:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Dataset</th>
<th style="text-align: right;">Mean x</th>
<th style="text-align: right;">Mean y</th>
<th style="text-align: right;">Var x</th>
<th style="text-align: right;">Var y</th>
<th style="text-align: right;">Std x</th>
<th style="text-align: right;">Std y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">I</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.75</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">1.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">II</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.75</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">1.94</td>
</tr>
<tr class="odd">
<td style="text-align: left;">III</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.75</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">1.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">IV</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3.75</td>
<td style="text-align: right;">3.16</td>
<td style="text-align: right;">1.94</td>
</tr>
</tbody>
</table>
<p>This statistical paradox is good reminder that descriptive statistics are remain a <strong>reduction of reality</strong>.</p>
</div>
</div>
</div>
</section>
</section>
<section id="standardising-series-with-mean-and-standard-deviation" class="level3" data-number="20.3.2">
<h3 data-number="20.3.2" class="anchored" data-anchor-id="standardising-series-with-mean-and-standard-deviation"><span class="header-section-number">20.3.2</span> Standardising series with Mean and Standard Deviation</h3>
<section id="mean-centre" class="level4" data-number="20.3.2.1">
<h4 data-number="20.3.2.1" class="anchored" data-anchor-id="mean-centre"><span class="header-section-number">20.3.2.1</span> Mean Centre</h4>
<p>Going back to the three example series:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/three_series.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Three series with different means and variances</figcaption>
</figure>
</div>
<p>How could these be standardised so that they have the same mean and spread?</p>
<p>First, by subtracting the mean to each observation, the two series could both be centred around 0.</p>
<p><span class="math display">\[
x_{\text{mean centred}} = x - \bar{x}
\]</span></p>
<p>A good first step:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/three_series_mean_centred.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Three series, mean centred</figcaption>
</figure>
</div>
<p>But the three series still have widely different spreads.</p>
</section>
<section id="variance-scaling" class="level4" data-number="20.3.2.2">
<h4 data-number="20.3.2.2" class="anchored" data-anchor-id="variance-scaling"><span class="header-section-number">20.3.2.2</span> Variance Scaling</h4>
<p>To make sure both series have the same <strong>variance</strong>, or spread around the mean, you could simply <strong>divide</strong> all numbers of the resulting series by the standard deviation:</p>
<p><span class="math display">\[
x_{\text{standardised}} = \frac{x - \bar{x}}{\sigma}
\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/scaling/three_series_standardised.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Three series, standardised</figcaption>
</figure>
</div>
<p>Standardising series in this way, we preserve the information they contain while aligning their mean and variance.</p>
</section>
<section id="example" class="level4" data-number="20.3.2.3">
<h4 data-number="20.3.2.3" class="anchored" data-anchor-id="example"><span class="header-section-number">20.3.2.3</span> Example</h4>
<p>Let’s go back to the example data and scale the Size (m²) series:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Size (m²)</th>
<th style="text-align: center;">Number of rooms</th>
<th style="text-align: center;">Price (k €)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">320</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">400</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">350</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">310</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">600</td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">330</td>
</tr>
</tbody>
</table>
<p>To do so, we need to compute the series mean and variance:</p>
<p><span class="math display">\[\begin{aligned}
\text{Mean} &amp;= \frac{60 + 80 + 120 + 70 + 150 + 90}{6} = \frac{570}{6} = 95 \\
\text{Variance} &amp;= \frac{(60 - 95)^2 + (80 - 95)^2 + (120 - 95)^2}{6} \\
&amp;\quad + \frac{(70 - 95)^2 + (150 - 95)^2 + (90 - 95)^2}{6} \\
&amp;= \frac{5750}{6} \approx 958.3 \\
\text{Standard Deviation} &amp;= \sqrt{\text{Variance}} = \sqrt{958.3} \approx 31
\end{aligned}
\]</span></p>
<p>Standardised series:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Size (m²)</th>
<th style="text-align: center;">Scaled Size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;"><span class="math inline">\(\frac{60-95}{31} = -1.13\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;"><span class="math inline">\(\frac{80-95}{31} = -0.48\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;"><span class="math inline">\(\frac{120-95}{31} = 0.81\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;"><span class="math inline">\(\frac{70-95}{31} = -0.81\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;"><span class="math inline">\(\frac{150-95}{31} = 1.77\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;"><span class="math inline">\(\frac{90-95}{31} = -0.16\)</span></td>
</tr>
</tbody>
</table>
<div id="exr-stand-data" class="exercise theorem">
<p><span class="theorem-title"><strong>Exercise 20.4</strong></span> &nbsp;</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Size (m²)</th>
<th style="text-align: center;">Number of rooms</th>
<th style="text-align: center;">Price (k €)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">320</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">400</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">350</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">310</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">600</td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">330</td>
</tr>
</tbody>
</table>
<p>Standardise the “Number of Rooms” series.</p>
</div>
<p>That is it for scaling methods, well done for making it this far! The following section will cover some of the practical details, but no more maths, I promise.</p>
</section>
</section>
</section>
<section id="information-leakage" class="level2" data-number="20.4">
<h2 data-number="20.4" class="anchored" data-anchor-id="information-leakage"><span class="header-section-number">20.4</span> Information Leakage</h2>
<p>Data preprocessing is a common source of information leakage. Descriptive statistics like the minimum, maximum, mean and standard deviation of a series are a source of information.</p>
<p>When applying Min-Max Scaling or Standardisation, use descriptive statistics (like min and max) computed from the <strong>training set only</strong>. When generating predictions on the test set, preprocess the data using the descriptive statistics of the training set.</p>
<p>As an example, for Min-Max Scaling, you would use the minimum and maximum of the training set to preprocess the test data. This sounds counter-intuitive and a lot of work, why should we bother?</p>
<p>The answer to that question can be found in the reason we split the data into train and test sets. We want to estimate how the model would perform on <strong>unseen data</strong>.</p>
<p>In the case of property pricing, imagine you have trained your model using Min-Max Scaler, and that a new property comes in, ready to be priced. How would you scale the features (area and number of rooms) of this new property?</p>
<p>The descriptive statistics of this property are irrelevant as you only have a single observation. You would use the min and max of the <strong>training data</strong>, the only data you have. Because the purpose of the test set is to simulate what would happen at prediction time, it makes sense to treat it in the same way.</p>
<p>In Machine Learning jargon, these scaling methods are <strong>fitted</strong> to the training data, and applied to the test set. The transformation is based on metrics calculated on the training set and applied to the test set.</p>
</section>
<section id="final-thoughts" class="level2" data-number="20.5">
<h2 data-number="20.5" class="anchored" data-anchor-id="final-thoughts"><span class="header-section-number">20.5</span> Final Thoughts</h2>
<p>Some models like KNN require numerical features to be on the same scale. Otherwise, features with the largest variance (here surface area) will dominate distance calculations. This chapter reviewed two ways to scale numerical features:</p>
<ul>
<li>Min-Max Scaling</li>
<li>Standardisation</li>
</ul>
<p>Both of these need to be applied with care to avoid information leakage between the train and test sets. The way to do so is to use the descriptive statistics of the training set to preprocess the test data. This is what happens at inference.</p>
<p>This is it, you made it! This was the last chapter of the Data Preprocessing section. The next section will put everything together - applying the book’s content to an end-to-end Machine Learning project.</p>
</section>
<section id="solutions" class="level2" data-number="20.6">
<h2 data-number="20.6" class="anchored" data-anchor-id="solutions"><span class="header-section-number">20.6</span> Solutions</h2>
<div id="sol-min-max" class="proof solution">
<p><span class="proof-title"><em>Solution 20.1</em>. </span><a href="#exr-min-max" class="quarto-xref">Exercise&nbsp;<span>20.1</span></a></p>
<p>Given the data:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Size (m²)</th>
<th style="text-align: center;">Number of rooms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">5</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
<p>Min-Max Scaling formula: <span class="math display">\[
\text{Scaled Value} = \frac{x - x_{\text{min}}}{x_{\text{max}} - x_{\text{min}}}
\]</span></p>
<ol type="1">
<li>Surface Area (Size in m²)</li>
</ol>
<ul>
<li><span class="math inline">\(x_{\text{min}} = 60\)</span></li>
<li><span class="math inline">\(x_{\text{max}} = 150\)</span></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 26%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Size (m²)</th>
<th style="text-align: center;">Scaled Size (<span class="math inline">\(x'\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;"><span class="math inline">\(\frac{60-60}{150-60} = 0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;"><span class="math inline">\(\frac{80-60}{150-60} = \frac{20}{90} \approx 0.222\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;"><span class="math inline">\(\frac{120-60}{150-60} = \frac{60}{90} \approx 0.667\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;"><span class="math inline">\(\frac{70-60}{150-60} = \frac{10}{90} \approx 0.111\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;"><span class="math inline">\(\frac{150-60}{150-60} = 1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;"><span class="math inline">\(\frac{90-60}{150-60} = \frac{30}{90} \approx 0.333\)</span></td>
</tr>
</tbody>
</table>
<hr>
<ol start="2" type="1">
<li>Number of Rooms</li>
</ol>
<ul>
<li><span class="math inline">\(x_{\text{min}} = 2\)</span></li>
<li><span class="math inline">\(x_{\text{max}} = 6\)</span></li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Number of rooms</th>
<th style="text-align: center;">Scaled Rooms (<span class="math inline">\(x'\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(\frac{2-2}{6-2} = 0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="math inline">\(\frac{3-2}{6-2} = \frac{1}{4} = 0.25\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;"><span class="math inline">\(\frac{5-2}{6-2} = \frac{3}{4} = 0.75\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(\frac{2-2}{6-2} = 0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;"><span class="math inline">\(\frac{6-2}{6-2} = 1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span class="math inline">\(\frac{4-2}{6-2} = \frac{2}{4} = 0.5\)</span></td>
</tr>
</tbody>
</table>
<p>Scaled Data</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Scaled Size</th>
<th style="text-align: center;">Scaled Rooms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">0.222</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">0.667</td>
<td style="text-align: center;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">0.111</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">0.333</td>
<td style="text-align: center;">0.5</td>
</tr>
</tbody>
</table>
</div>
<div id="sol-mean-series" class="proof solution">
<p><span class="proof-title"><em>Solution 20.2</em>. </span><a href="#exr-mean-series" class="quarto-xref">Exercise&nbsp;<span>20.2</span></a></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Series 1</th>
<th style="text-align: center;">Series 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">16</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\text{Mean}_{x_2} = \frac{4 + 8 + 10 + 12 + 16}{5} = 10
\]</span></p>
</div>
<div id="sol-variance" class="proof solution">
<p><span class="proof-title"><em>Solution 20.3</em>. </span><a href="#exr-variance" class="quarto-xref">Exercise&nbsp;<span>20.3</span></a></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Series 1</th>
<th style="text-align: center;">Series 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">10</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">11</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="odd">
<td style="text-align: center;">14</td>
<td style="text-align: center;">16</td>
</tr>
</tbody>
</table>
<p>For Series 2: [4, 8, 10, 12, 16]:</p>
<p><span class="math display">\[
\bar{x}_2 = \frac{4 + 8 + 10 + 12 + 16}{5} = 10
\]</span></p>
<p>Variance: <span class="math display">\[\begin{aligned}
\mathrm{Var}(x_2) &amp;= \frac{(4-10)^2 + (8-10)^2 + (10-10)^2 + (12-10)^2 + (16-10)^2}{5} \\
&amp;= \frac{36 + 4 + 0 + 4 + 36}{5} = \frac{80}{5} = 16
\end{aligned}
\]</span></p>
</div>
<div id="sol-stand-data" class="proof solution">
<p><span class="proof-title"><em>Solution 20.4</em>. </span><a href="#exr-stand-data" class="quarto-xref">Exercise&nbsp;<span>20.4</span></a></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Size (m²)</th>
<th style="text-align: center;">Number of rooms</th>
<th style="text-align: center;">Price (k €)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">320</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">400</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">350</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">310</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">150</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">600</td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">90</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">330</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\text{Mean} = \frac{2 + 3 + 5 + 2 + 6 + 4}{6} = \frac{22}{6} \approx 3.67
\]</span> <span class="math display">\[
\begin{aligned}
\text{Variance} &amp;= \frac{(2 - 3.67)^2 + (3 - 3.67)^2 + (5 - 3.67)^2}{6} \\
&amp;\quad + \frac{(2 - 3.67)^2 + (6 - 3.67)^2 + (4 - 3.67)^2}{6} \\
&amp;= \frac{13.33}{6} \approx 2.22
\end{aligned}
\]</span> <span class="math display">\[\text{Standard Deviation} = \sqrt{\text{Variance}} = \sqrt{2.22} \approx 1.49\]</span></p>
<p><strong>Standardised series</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Number of rooms</th>
<th style="text-align: center;">Scaled Number of Rooms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(\frac{2 - 3.67}{1.49} = -1.12\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;"><span class="math inline">\(\frac{3 - 3.67}{1.49} = -0.45\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;"><span class="math inline">\(\frac{5 - 3.67}{1.49} = 0.89\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;"><span class="math inline">\(\frac{2 - 3.67}{1.49} = -1.12\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;"><span class="math inline">\(\frac{6 - 3.67}{1.49} = 1.56\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;"><span class="math inline">\(\frac{4 - 3.67}{1.49} = 0.22\)</span></td>
</tr>
</tbody>
</table>
</div>


</section>

</main> <!-- /main -->
<div id="cookie-banner" style="position: fixed; bottom: 0; width: 100%; background: #f9f9f9; padding: 10px; text-align: center; border-top: 1px solid #ccc; z-index: 1000; font-size: 14px;">
  <p style="margin: 0; display: flex; justify-content: center; align-items: center; gap: 10px;">
    As a data guy, I collect data. 🍪 By using this site, you agree to the use of cookies.
    <button id="accept-cookies" style="padding: 10px 20px; background-color: #517699; border: none; border-radius: 6px; font-size: 14px; color: #fff; font-weight: bold; cursor: pointer; transition: background-color 0.3s;">
      Got it!
    </button>
  </p>
</div>
<script>
  document.getElementById('accept-cookies').addEventListener('click', function() {
    document.getElementById('cookie-banner').style.display = 'none';
    localStorage.setItem('cookiesAccepted', 'true');
  });

  if (localStorage.getItem('cookiesAccepted') === 'true') {
    document.getElementById('cookie-banner').style.display = 'none';
  }
</script>
<div class="reciprocity-container">
    <p class="reciprocity-text">
        If this book helped you today, consider supporting the project 
        by buying the ebook, including notebooks and video walkthroughs.
    </p>
    <a href="https://kalfonel.gumroad.com/l/cnyuez" class="reciprocity-button" target="_blank" onclick="gtag('event', 'click', {'event_category': 'engagement', 'event_label': 'footer_ebook_link'});">
       Buy the Ebook
    </a>
</div>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/missing-categorical-values.html" class="pagination-link" aria-label="Dealing with Missing Categorical Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dealing with Missing Categorical Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/end-to-end.html" class="pagination-link" aria-label="End-to-End Machine Learning Project">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">End-to-End Machine Learning Project</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright © Eliott Kalfon 2025. All rights reserved.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>