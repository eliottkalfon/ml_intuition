<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>19&nbsp; Dealing with Missing Numeric Data – Machine Learning Intuition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/missing-categorical-values.html" rel="next">
<link href="../chapters/datetime.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CRT8LCGF89"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CRT8LCGF89');
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/data-preprocessing.html">Data Preprocessing</a></li><li class="breadcrumb-item"><a href="../chapters/missing-numerical-values.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dealing with Missing Numeric Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Machine Learning Intuition</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../epigraph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">epigraph.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Introduction to Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">First Prediction with Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/defining-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Defining Prediction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/types-ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Other Types of Machine Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/ai-ml-ds.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Machine Learning, Artificial Intelligence and Data Science</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/data-space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data and Space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/distance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Distance and Similarity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/neighbours.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Neighbours</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Model Evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/model-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Model Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/evaluation-classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Evaluating Classification Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/evaluation-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Evaluating Regression Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Decision Trees</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/trees-intuition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Decision Trees</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/splitting-maths.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Evaluating Splits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/recursion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Splitting Recursively</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/trees-proba-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Probabilities and Regression with Decision Trees</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Preprocessing</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/data-preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Data Preprocessing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/categorical-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Encoding Categorical Features</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/datetime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Representing Dates</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/missing-numerical-values.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dealing with Missing Numeric Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/missing-categorical-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Dealing with Missing Categorical Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/scaling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Numerical Feature Scaling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Bringing it all Together</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/end-to-end.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">End-to-End Machine Learning Project</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/generative-ai.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Machine Learning and Generative AI</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../acknowledgments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Acknowledgments</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#are-all-missing-values-equal" id="toc-are-all-missing-values-equal" class="nav-link active" data-scroll-target="#are-all-missing-values-equal"><span class="header-section-number">19.1</span> Are All Missing Values Equal?</a>
  <ul class="collapse">
  <li><a href="#starting-with-why" id="toc-starting-with-why" class="nav-link" data-scroll-target="#starting-with-why"><span class="header-section-number">19.1.1</span> Starting with Why</a></li>
  <li><a href="#excluding-rows-with-missing-values" id="toc-excluding-rows-with-missing-values" class="nav-link" data-scroll-target="#excluding-rows-with-missing-values"><span class="header-section-number">19.1.2</span> Excluding Rows with Missing Values</a></li>
  <li><a href="#excluding-features-with-missing-values" id="toc-excluding-features-with-missing-values" class="nav-link" data-scroll-target="#excluding-features-with-missing-values"><span class="header-section-number">19.1.3</span> Excluding Features with Missing Values</a></li>
  <li><a href="#imputation-of-missing-numerical-values" id="toc-imputation-of-missing-numerical-values" class="nav-link" data-scroll-target="#imputation-of-missing-numerical-values"><span class="header-section-number">19.1.4</span> Imputation of Missing Numerical Values</a></li>
  </ul></li>
  <li><a href="#information-leakage" id="toc-information-leakage" class="nav-link" data-scroll-target="#information-leakage"><span class="header-section-number">19.2</span> Information Leakage</a></li>
  <li><a href="#final-thoughts" id="toc-final-thoughts" class="nav-link" data-scroll-target="#final-thoughts"><span class="header-section-number">19.3</span> Final Thoughts</a></li>
  <li><a href="#solutions" id="toc-solutions" class="nav-link" data-scroll-target="#solutions"><span class="header-section-number">19.4</span> Solutions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/data-preprocessing.html">Data Preprocessing</a></li><li class="breadcrumb-item"><a href="../chapters/missing-numerical-values.html"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dealing with Missing Numeric Data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Dealing with Missing Numeric Data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Data can sometimes be missing. These missing points are often represented as null or blank values.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 20%">
<col style="width: 24%">
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Flat</th>
<th style="text-align: center;">Surface Area (sq m)</th>
<th style="text-align: center;">Distance to Centre (km)</th>
<th style="text-align: center;">Neighb.</th>
<th style="text-align: center;">Energy Rating</th>
<th style="text-align: center;">Sell Price (K€)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">4.2</td>
<td style="text-align: center;">Neukölln</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">420</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">Kreuzberg</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">610</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">Charlott.</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">390</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">Kreuzberg</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">370</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">110</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">Charlott.</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">700</td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">Neukölln</td>
<td style="text-align: center;">F</td>
<td style="text-align: center;">310</td>
</tr>
</tbody>
</table>
<p>This is problematic for most Machine Learning models, as they <strong>cannot handle</strong> missing values.</p>
<p>Note: many modern implementations of Machine Learning models, like LightGBM, do natively handle missing values using some of the methods shown in this chapter. This is due to smart implementation; the underlying models still cannot read missing values.</p>
<p>As shown in previous chapters, these Machine Learning models learn the relationship between inputs and outputs:</p>
<p><span class="math display">\[
\text{Input} \longrightarrow \text{Model} \longrightarrow \text{Prediction}
\]</span></p>
<p>They use mathematical tricks (e.g., distance, data splitting) to learn the relationship between the features of each observation (e.g., property surface area) and the target variable (e.g., sell price).</p>
<p>The following chapter will explore different strategies to deal with missing values in a Machine Learning project.</p>
<section id="are-all-missing-values-equal" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="are-all-missing-values-equal"><span class="header-section-number">19.1</span> Are All Missing Values Equal?</h2>
<section id="starting-with-why" class="level3" data-number="19.1.1">
<h3 data-number="19.1.1" class="anchored" data-anchor-id="starting-with-why"><span class="header-section-number">19.1.1</span> Starting with Why</h3>
<p><strong>Why</strong> is this data point missing? There could be many reasons which may inform our approach to missing data.</p>
<p>With data problems, it is a good idea to start with the <strong>source</strong>. Is there an issue in the data collection process? Could there be a problem with the database? How many observations is this affecting?</p>
<p>Before developing a strategy, it is critical to understand if there is an issue with the data source. Data source problems could affect many other applications, such as reporting or operations.</p>
<p>Missing values can have different meanings:</p>
<ul>
<li>Missing at Random: the observation is missing for an unknown reason, without any apparent pattern</li>
<li>None: a missing transaction count could mean that no (or 0) transactions were made</li>
<li>Not Applicable: Missing product sub-category could mean that the current product does not have a sub-category</li>
<li>Missing Measurement: a missing temperature reading in some sensor data may mean that the measurement was skipped</li>
</ul>
<p>Before coming up with a strategy, it is critical to understand why these values are missing.</p>
</section>
<section id="excluding-rows-with-missing-values" class="level3" data-number="19.1.2">
<h3 data-number="19.1.2" class="anchored" data-anchor-id="excluding-rows-with-missing-values"><span class="header-section-number">19.1.2</span> Excluding Rows with Missing Values</h3>
<p>Is the missing data point critical? In the context of property pricing, the surface area is a critical data point. You may want to <strong>exclude</strong> the rows that have a key feature value missing.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 20%">
<col style="width: 24%">
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Flat</th>
<th style="text-align: center;">Surface Area (sq m)</th>
<th style="text-align: center;">Distance to Centre (km)</th>
<th style="text-align: center;">Neighb.</th>
<th style="text-align: center;">Energy Rating</th>
<th style="text-align: center;">Sell Price (K€)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">4.2</td>
<td style="text-align: center;">Neukölln</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">420</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">Kreuzberg</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">610</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">Charlott.</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">390</td>
</tr>
</tbody>
</table>
<p>Looking at the example above, you would remove property B from the training data.</p>
</section>
<section id="excluding-features-with-missing-values" class="level3" data-number="19.1.3">
<h3 data-number="19.1.3" class="anchored" data-anchor-id="excluding-features-with-missing-values"><span class="header-section-number">19.1.3</span> Excluding Features with Missing Values</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Surface Area (sq m)</th>
<th style="text-align: center;">Distance to Centre (km)</th>
<th style="text-align: center;">Neighb.</th>
<th style="text-align: center;">Energy Rating</th>
<th style="text-align: center;">Sell Price (K€)</th>
<th style="text-align: center;">Years since Build</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">85</td>
<td style="text-align: center;">4.2</td>
<td style="text-align: center;">Neukölln</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">420</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">120</td>
<td style="text-align: center;">2.5</td>
<td style="text-align: center;">Kreuzberg</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">610</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">6.1</td>
<td style="text-align: center;">Charlott.</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">390</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">70</td>
<td style="text-align: center;">3.8</td>
<td style="text-align: center;">Kreuzberg</td>
<td style="text-align: center;">D</td>
<td style="text-align: center;">370</td>
<td style="text-align: center;">22</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">110</td>
<td style="text-align: center;">1.2</td>
<td style="text-align: center;">Charlott.</td>
<td style="text-align: center;">B</td>
<td style="text-align: center;">700</td>
<td style="text-align: center;">12</td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">5.0</td>
<td style="text-align: center;">Neukölln</td>
<td style="text-align: center;">F</td>
<td style="text-align: center;">310</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>In the above example, the column <strong>Years since Build</strong> has many missing values. It would make sense to either review the underlying data or remove it from the dataset.</p>
<p>Filtering out both rows and columns containing missing values may <strong>reduce the amount of data available</strong> to the model. For this reason, more sophisticated approaches are sometimes needed.</p>
</section>
<section id="imputation-of-missing-numerical-values" class="level3" data-number="19.1.4">
<h3 data-number="19.1.4" class="anchored" data-anchor-id="imputation-of-missing-numerical-values"><span class="header-section-number">19.1.4</span> Imputation of Missing Numerical Values</h3>
<p>For numerical features, missing values can be handled with a method called <strong>imputation</strong>. This fills missing values with another substitute value.</p>
<section id="imputation-by-0" class="level4" data-number="19.1.4.1">
<h4 data-number="19.1.4.1" class="anchored" data-anchor-id="imputation-by-0"><span class="header-section-number">19.1.4.1</span> Imputation by 0</h4>
<p>When the missing value means “None”, like the missing number of transactions, it is a good idea to replace missing values with 0.</p>
<p>Imagine the data above also included “Balcony Area” in square meters. A missing value could mean “no balcony” and could safely be replaced by 0. Before doing so, ensure that a missing “Balcony Area” really means “no balcony”. In general, these data processing methods rely on a solid understanding of the data and problem.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Property</th>
<th style="text-align: center;">Total Area (sq m)</th>
<th style="text-align: center;">Balcony Area (sq m)</th>
<th style="text-align: center;">Sell Price (K€)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">95</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">450</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">280</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">110</td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">510</td>
</tr>
</tbody>
</table>
</section>
<section id="imputation-by-the-mean" class="level4" data-number="19.1.4.2">
<h4 data-number="19.1.4.2" class="anchored" data-anchor-id="imputation-by-the-mean"><span class="header-section-number">19.1.4.2</span> Imputation by the Mean</h4>
<p>When values are <strong>missing at random</strong>, the mean or median could be good candidates for imputation.</p>
<p>In a dataset containing student heights:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Student</th>
<th style="text-align: center;">Height (cm)</th>
<th style="text-align: center;">Gender</th>
<th style="text-align: center;">Grade</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">170</td>
<td style="text-align: center;">M</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">F</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">165</td>
<td style="text-align: center;">F</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">M</td>
<td style="text-align: center;">11</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">172</td>
<td style="text-align: center;">M</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">F</td>
<td style="text-align: center;">9</td>
</tr>
</tbody>
</table>
<p>A good strategy to deal with missing heights is to impute student height using the <strong>average height</strong> of all students. With a large enough dataset, a more fine-grained approach could be used. You could, for example, impute the missing heights based on students within the same grade.</p>
<p>To impute the Height of student B, we calculate the average height over all students:</p>
<p><span class="math display">\[
\text{Mean} = \frac{170 + 165 + 180 + 172 + 160}{5} = 169.4
\]</span></p>
<p>The Height of student B would be replaced by <span class="math inline">\(169.4\)</span>.</p>
</section>
<section id="imputation-by-the-median" class="level4" data-number="19.1.4.3">
<h4 data-number="19.1.4.3" class="anchored" data-anchor-id="imputation-by-the-median"><span class="header-section-number">19.1.4.3</span> Imputation by the Median</h4>
<p>The <strong>median</strong> could also be a good choice of substitute value for imputation. The median of a series is the <strong>middle number</strong> in a sorted list. Taking the list: <span class="math inline">\([2,3,4,5,7,9,50]\)</span> as example, the median is <span class="math inline">\(5\)</span>. In other words, it is the value such that at least 50% of the values are less than or equal to it. One advantage of the median is that it is not sensitive to outliers.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Mean, median and outliers
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>An <strong>outlier</strong> is a data point that is very different to the others</p>
<p>Considering the following series:</p>
<p><span class="math inline">\([2,3,4,5,7,9,50]\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/missing-values/series_with_outlier.png" class="img-fluid figure-img"></p>
<figcaption>Series with outlier</figcaption>
</figure>
</div>
<p>The point at <span class="math inline">\(50\)</span> is an outlier of this distribution, as it is very far from the others. The mean of the series is affected by this number:</p>
<div id="exr-outlier" class="exercise theorem">
<p><span class="theorem-title"><strong>Exercise 19.1</strong></span> Calculate the mean and median of this series. Show that the mean is <span class="math inline">\(11.43\)</span>, and that the median is <span class="math inline">\(5\)</span>.</p>
</div>
<div id="exr-outlier-rm" class="exercise theorem">
<p><span class="theorem-title"><strong>Exercise 19.2</strong></span> Show that after removing the item <span class="math inline">\(50\)</span>, the mean is <span class="math inline">\(5.0\)</span>, and the median is <span class="math inline">\(4.5\)</span>.</p>
</div>
<p>As you may have observed, the mean varies widely, whereas the median remains stable.</p>
</div>
</div>
</div>
<div id="exr-odd-median" class="exercise theorem">
<p><span class="theorem-title"><strong>Exercise 19.3</strong></span> Find the median of the following series:</p>
<ul>
<li><span class="math inline">\({5, 7, 9, 12, 15}\)</span></li>
<li><span class="math inline">\({1, 2, 2, 4, 8, 10, 13}\)</span></li>
</ul>
</div>
<p>What happens when the length of the series is an even number?</p>
<p>Looking at the following series: <span class="math inline">\([1,2,3,4]\)</span>, what would be the middle value? As the series contains an even number of items, there is no middle value.</p>
<p>By convention, the median of these series is the average between the two middle values. Here, the median would be <span class="math inline">\(\frac{2+3}{2} = 2.5\)</span>.</p>
<div id="exr-even-median" class="exercise theorem">
<p><span class="theorem-title"><strong>Exercise 19.4</strong></span> Find the median of the following series:</p>
<ul>
<li><span class="math inline">\({2, 3, 5, 8}\)</span></li>
<li><span class="math inline">\({4, 6, 8, 10, 12, 14}\)</span></li>
</ul>
</div>
<p>Going back to the student data:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Student</th>
<th style="text-align: center;">Height (cm)</th>
<th style="text-align: center;">Gender</th>
<th style="text-align: center;">Grade</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A</td>
<td style="text-align: center;">170</td>
<td style="text-align: center;">M</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: center;">B</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">F</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="odd">
<td style="text-align: center;">C</td>
<td style="text-align: center;">165</td>
<td style="text-align: center;">F</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center;">D</td>
<td style="text-align: center;">180</td>
<td style="text-align: center;">M</td>
<td style="text-align: center;">11</td>
</tr>
<tr class="odd">
<td style="text-align: center;">E</td>
<td style="text-align: center;">172</td>
<td style="text-align: center;">M</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">F</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">F</td>
<td style="text-align: center;">9</td>
</tr>
</tbody>
</table>
<p>To impute the Height of student B with the median, we find the median. The median of the heights is <span class="math inline">\(170\)</span>, as it is the middle number in the sorted Height series: <span class="math inline">\({160, 165, 170, 172, 180}\)</span>.</p>
</section>
<section id="imputation-of-time-series-data" class="level4" data-number="19.1.4.4">
<h4 data-number="19.1.4.4" class="anchored" data-anchor-id="imputation-of-time-series-data"><span class="header-section-number">19.1.4.4</span> Imputation of Time-Series Data</h4>
<p>Time-series data is data with a <strong>time</strong> dimension. As an example, the following data could be the temperature of a machine in a factory:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Time (s)</th>
<th style="text-align: center;">Temperature (°C)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">18.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">18.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">19.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">20.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">20.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">22.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">22.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">23.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">11</td>
<td style="text-align: center;">26.2</td>
</tr>
</tbody>
</table>
<p>Time-series data is also often represented as a line chart:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/missing-values/time_series_missing_values.png" class="img-fluid figure-img"></p>
<figcaption>Temperature time series with missing values</figcaption>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>But what is time?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Time can be defined as the continuous and apparently irreversible progress of existence. Just like “truth” or “space”, the definitions of the foundational aspects of experience can sometimes be disappointing.</p>
</div>
</div>
</div>
<section id="using-the-mean-and-median" class="level5" data-number="19.1.4.4.1">
<h5 data-number="19.1.4.4.1" class="anchored" data-anchor-id="using-the-mean-and-median"><span class="header-section-number">19.1.4.4.1</span> Using the Mean and Median</h5>
<p>Imputing null values with the mean and median could lead to some unintuitive results.</p>
<div id="exr-time-imp" class="exercise theorem">
<p><span class="theorem-title"><strong>Exercise 19.5</strong></span> Impute the null values of the following series using mean, then the median. To do so, show that the mean of the series is <span class="math inline">\(21.22\)</span> and the median is <span class="math inline">\(20.8\)</span>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Time (s)</th>
<th style="text-align: center;">Temperature (°C)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">18.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">18.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">19.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">20.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">20.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">22.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">22.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">23.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">11</td>
<td style="text-align: center;">26.2</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/missing-values/time_series_mean.png" class="img-fluid figure-img"></p>
<figcaption>Imputation of missing values by mean</figcaption>
</figure>
</div>
</section>
<section id="alternative-methods" class="level5" data-number="19.1.4.4.2">
<h5 data-number="19.1.4.4.2" class="anchored" data-anchor-id="alternative-methods"><span class="header-section-number">19.1.4.4.2</span> Alternative Methods</h5>
<p>What would be a better method? In these time-series tasks, imputation by the <strong>previous value</strong> could be a good idea. This method is called <strong>forward-fill</strong>. It assumes that the value remains constant until a new measurement is taken.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/missing-values/time_series_previous.png" class="img-fluid figure-img"></p>
<figcaption>Imputation by previous value</figcaption>
</figure>
</div>
<p>The series looks more natural than with mean-imputation. Still, we can do better.</p>
<p>Another approach is to impute the missing values by computing the average of the two neighboring values. This method, often called <strong>linear interpolation</strong>, is particularly useful for data with a clear trend, as it smoothly connects the known data points.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/missing-values/time_series_neighbours.png" class="img-fluid figure-img"></p>
<figcaption>Imputation by neighbours</figcaption>
</figure>
</div>
<p>That looks more like it!</p>
</section>
</section>
<section id="wrapping-up" class="level4" data-number="19.1.4.5">
<h4 data-number="19.1.4.5" class="anchored" data-anchor-id="wrapping-up"><span class="header-section-number">19.1.4.5</span> Wrapping Up</h4>
<p>There are many ways to impute numerical values, and no optimal solution. The choice comes down to the specific problem at hand. Remember that before coming up with an imputation strategy, it is critical to understand why the values are missing.</p>
</section>
</section>
</section>
<section id="information-leakage" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="information-leakage"><span class="header-section-number">19.2</span> Information Leakage</h2>
<p>As mentioned in the introduction to this chapter, data preprocessing is a step in which information leakage commonly occurs. Dealing with missing values is no exception.</p>
<p>In the process of filling numerical null values with the median or the average (or anything calculated from the data), it is important to calculate these numbers from <strong>the training set only</strong>.</p>
<p>Then, null values in the test set would be imputed with the metrics calculated with the training data.</p>
<p>Why is this the case? Because this is exactly what would happen as the model is used to predict <strong>new observations</strong>. When the model will predict the price of a new property, and that property has a missing value, how will it be imputed?</p>
<p>At this point, the only information available will be the training data. The missing values will be imputed using <strong>the mean or median of the training data</strong>.</p>
<p>The purpose of generating predictions on the test set is to estimate model performance on unseen data. Null values in the test set should be treated in the same way as missing values in unseen data.</p>
<p>In Machine Learning practice, these preprocessing methods are said to be <strong>fitted</strong> on the training set and applied to the test set. This fitting is the calculation of descriptive statistics.</p>
</section>
<section id="final-thoughts" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="final-thoughts"><span class="header-section-number">19.3</span> Final Thoughts</h2>
<p>This chapter walked through handling missing numerical values with the following steps:</p>
<ul>
<li>Understand why the values are missing</li>
<li>Develop a strategy: filtering or different types of imputation</li>
<li>Fit the imputation method to the training data</li>
<li>Impute null values in the test set using training data statistics</li>
</ul>
<p>It is important to remember to avoid information leakage in null value handling. This can be done by a clear separation of the training and test set, before data preprocessing.</p>
<p>Looking at the previous example, what if the “Neighbourhood” column was missing? The following section will explore how to handle missing <strong>categorical</strong> values.</p>
</section>
<section id="solutions" class="level2" data-number="19.4">
<h2 data-number="19.4" class="anchored" data-anchor-id="solutions"><span class="header-section-number">19.4</span> Solutions</h2>
<div id="sol-outlier" class="proof solution">
<p><span class="proof-title"><em>Solution 19.1</em>. </span><a href="#exr-outlier" class="quarto-xref">Exercise&nbsp;<span>19.1</span></a></p>
<p>Series: <span class="math inline">\([2,3,4,5,7,9,50]\)</span></p>
<p><span class="math display">\[
\text{Mean} = \frac{2 + 3 + 4 + 5 + 7 + 9 + 50}{7} = \frac{80}{7} \approx 11.43
\]</span></p>
<p>The median is the middle number of the sorted series. Here, <span class="math inline">\(5\)</span>.</p>
</div>
<div id="sol-outlier-rm" class="proof solution">
<p><span class="proof-title"><em>Solution 19.2</em>. </span><a href="#exr-outlier-rm" class="quarto-xref">Exercise&nbsp;<span>19.2</span></a></p>
<p>Series: <span class="math inline">\([2,3,4,5,7,9]\)</span></p>
<p><span class="math display">\[
\text{Mean} = \frac{2 + 3 + 4 + 5 + 7 + 9}{6} = \frac{30}{6} = 5
\]</span></p>
<p>As the series now contains an even number of observations, the median is the average of the two middle numbers, here <span class="math inline">\(\frac{4+5}{2} = 4.5\)</span>.</p>
</div>
<div id="sol-odd-median" class="proof solution">
<p><span class="proof-title"><em>Solution 19.3</em>. </span><a href="#exr-odd-median" class="quarto-xref">Exercise&nbsp;<span>19.3</span></a></p>
<ul>
<li><span class="math inline">\({5, 7, 9, 12, 15}, \text{Median} = 9\)</span></li>
<li><span class="math inline">\({1, 2, 2, 4, 8, 10, 13}, \text{Median} = 4\)</span></li>
</ul>
</div>
<div id="sol-even-median" class="proof solution">
<p><span class="proof-title"><em>Solution 19.4</em>. </span><a href="#exr-even-median" class="quarto-xref">Exercise&nbsp;<span>19.4</span></a></p>
<ul>
<li><span class="math inline">\({2, 3, 5, 8}, \text{Median} = \frac{3 + 5}{2} = 4\)</span></li>
<li><span class="math inline">\({4, 6, 8, 10, 12, 14}, \text{Median} = \frac{8 + 10}{2} = 9\)</span></li>
</ul>
</div>
<div id="sol-time-imp" class="proof solution">
<p><span class="proof-title"><em>Solution 19.5</em>. </span><a href="#exr-time-imp" class="quarto-xref">Exercise&nbsp;<span>19.5</span></a></p>
<p>For imputation, we need to compute both the mean and median:</p>
<p><span class="math display">\[
\begin{aligned}
\text{Mean} &amp;= \frac{18 + 18.5 + 19.1 + 20 + 20.8 + 22.1 + 22.8 + 23.5 + 26.2}{9} \\
&amp;= \frac{191}{9} = 21.22
\end{aligned}
\]</span></p>
<p>The median is the middle number of the sorted series:</p>
<p><span class="math inline">\({18, 18.5, 19.1, 20.0, 20.8, 22.1, 22.8, 23.5, 26.2}\)</span></p>
<p>Here: <span class="math inline">\(20.8\)</span></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 19%">
<col style="width: 35%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Time</th>
<th style="text-align: center;">Temperature (°C)</th>
<th style="text-align: center;">Temperature (Mean Imputation)</th>
<th style="text-align: center;">Temperature (Median Imputation)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">18.0</td>
<td style="text-align: center;">18.0</td>
<td style="text-align: center;">18.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">18.5</td>
<td style="text-align: center;">18.5</td>
<td style="text-align: center;">18.5</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">19.1</td>
<td style="text-align: center;">19.1</td>
<td style="text-align: center;">19.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">20.0</td>
<td style="text-align: center;">20.0</td>
<td style="text-align: center;">20.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">20.8</td>
<td style="text-align: center;">20.8</td>
<td style="text-align: center;">20.8</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">21.22</td>
<td style="text-align: center;">20.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">7</td>
<td style="text-align: center;">22.1</td>
<td style="text-align: center;">22.1</td>
<td style="text-align: center;">22.1</td>
</tr>
<tr class="even">
<td style="text-align: center;">8</td>
<td style="text-align: center;">22.8</td>
<td style="text-align: center;">22.8</td>
<td style="text-align: center;">22.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">9</td>
<td style="text-align: center;">23.5</td>
<td style="text-align: center;">23.5</td>
<td style="text-align: center;">23.5</td>
</tr>
<tr class="even">
<td style="text-align: center;">10</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">21.22</td>
<td style="text-align: center;">20.8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">11</td>
<td style="text-align: center;">26.2</td>
<td style="text-align: center;">26.2</td>
<td style="text-align: center;">26.2</td>
</tr>
</tbody>
</table>
</div>


</section>

</main> <!-- /main -->
<div id="cookie-banner" style="position: fixed; bottom: 0; width: 100%; background: #f9f9f9; padding: 10px; text-align: center; border-top: 1px solid #ccc; z-index: 1000; font-size: 14px;">
  <p style="margin: 0; display: flex; justify-content: center; align-items: center; gap: 10px;">
    As a data guy, I collect data. 🍪 By using this site, you agree to the use of cookies.
    <button id="accept-cookies" style="padding: 10px 20px; background-color: #517699; border: none; border-radius: 6px; font-size: 14px; color: #fff; font-weight: bold; cursor: pointer; transition: background-color 0.3s;">
      Got it!
    </button>
  </p>
</div>
<script>
  document.getElementById('accept-cookies').addEventListener('click', function() {
    document.getElementById('cookie-banner').style.display = 'none';
    localStorage.setItem('cookiesAccepted', 'true');
  });

  if (localStorage.getItem('cookiesAccepted') === 'true') {
    document.getElementById('cookie-banner').style.display = 'none';
  }
</script>
<div class="reciprocity-container">
    <p class="reciprocity-text">
        If this book helped you today, consider supporting the project 
        by buying the ebook, including notebooks and video walkthroughs.
    </p>
    <a href="https://kalfonel.gumroad.com/l/cnyuez" class="reciprocity-button" target="_blank" onclick="gtag('event', 'click', {'event_category': 'engagement', 'event_label': 'footer_ebook_link'});">
       Buy the Ebook
    </a>
</div>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/datetime.html" class="pagination-link" aria-label="Representing Dates">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Representing Dates</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/missing-categorical-values.html" class="pagination-link" aria-label="Dealing with Missing Categorical Data">
        <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Dealing with Missing Categorical Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright © Eliott Kalfon 2025. All rights reserved.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>